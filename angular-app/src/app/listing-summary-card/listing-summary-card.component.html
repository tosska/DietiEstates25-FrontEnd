<!-- 
  Questa è la card di riepilogo dell'annuncio.
  Design "Vetrina Moderna": Immagine hero in alto, 
  contenuto principale sotto e barra statistiche in basso.
-->
@if (listing) {
  <div class="mb-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden">
    
    <!-- Sezione Immagine (Superiore) con testo sovrapposto -->
    <div class="relative">
      <!-- Immagine -->
      <img [src]="getMainPhotoUrl(listing)" 
           [alt]="'Foto principale di ' + listing.title"
           class="object-cover w-full h-56"> <!-- Modificato: h-64 -> h-56 -->
      
      <!-- Gradiente per leggibilità testo -->
      <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/30 to-transparent"></div>

      <!-- Badge Stato (in alto a destra) -->
      <span class="absolute top-4 right-4 inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold"
            [ngClass]="{
              'bg-green-100 text-green-800': listing.status === 'Active',
              'bg-yellow-100 text-yellow-800': listing.status === 'Pending',
              'bg-gray-200 text-gray-800': listing.status !== 'Active' && listing.status !== 'Pending'
            }">
        {{ listing.status }}
      </span>

      <!-- Testo Principale (in basso a sinistra) -->
      <div class="absolute bottom-5 left-5"> <!-- Modificato: bottom-6 left-6 -> bottom-5 left-5 -->
        <h2 class="text-2xl font-bold text-white shadow-md">{{ listing.title }}</h2> <!-- Modificato: text-3xl -> text-2xl -->
        <!-- 
          ASSUNZIONE: L'oggetto Address ha le proprietà 'street', 'houseNumber' e 'city'.
          Modifica se necessario.
        -->
        <p class="mt-1 text-sm text-gray-200 shadow-md">
          {{ listing.Address.street }} {{ listing.Address.houseNumber }}, {{ listing.Address.city }}
        </p>
      </div>
    </div>

    <!-- Sezione Dati Principali (Prezzo e Tipo) -->
    <div class="p-5"> <!-- Modificato: p-6 -> p-5 -->
      <div class="flex flex-col sm:flex-row justify-between sm:items-center">
        <!-- Prezzo -->
        <div>
          <p class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Prezzo</p>
          <span class="text-3xl font-bold text-green-600 dark:text-green-400"> <!-- Modificato: text-4xl -> text-3xl -->
            {{ listing.price | currency:'EUR':'symbol':'1.0-0' }}
          </span>
        </div>
        <!-- Tipo Annuncio (es. Vendita) -->
        <div class="mt-4 sm:mt-0 sm:text-right">
          <p class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Tipo Annuncio</p>
          <span class="text-xl font-semibold text-gray-900 dark:text-white">
            {{ listing.listingType }}
          </span>
        </div>
      </div>
    </div>

    <!-- Barra Statistiche (Inferiore) -->
    <div class="flex items-center space-x-6 text-gray-700 dark:text-gray-300 border-t border-gray-200 dark:border-gray-700 px-5 py-3 bg-gray-50 dark:bg-gray-700/50"> <!-- Modificato: px-6 py-4 -> px-5 py-3 -->
      <!-- Area -->
      <div class="flex items-center" title="Superficie">
        <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 1v4m0 0h-4m4 0l-5-5" />
        </svg>
        <span class="text-sm">{{ listing.area }} m²</span>
      </div>
      <!-- Stanze -->
      <div class="flex items-center" title="Numero Stanze">
        <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
          <path d="M10 3.5A1.5 1.5 0 0111.5 5v1.5H16a2 2 0 012 2V15a2 2 0 01-2 2H4a2 2 0 01-2-2V8.5a2 2 0 012-2h4.5V5A1.5 1.5 0 0110 3.5zM4 9v6h12V9H4z" />
        </svg>
        <span class="text-sm">{{ listing.numberRooms }} stanze</span>
      </div>
      <!-- Anno Costruzione -->
      <div class="flex items-center" title="Anno Costruzione">
        <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd" />
        </svg>
        <span class="text-sm">{{ listing.constructionYear }}</span>
      </div>
    </div>
  </div>

} @else {
  <!-- Mostra uno scheletro di caricamento che corrisponde al new design -->
  <div class="mb-8 bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden animate-pulse">
    <!-- Immagine Placeholder -->
    <div class="w-full h-56 bg-gray-300 dark:bg-gray-700"></div> <!-- Modificato: h-64 -> h-56 -->
    
    <!-- Contenuto Placeholder -->
    <div class="p-5"> <!-- Modificato: p-6 -> p-5 -->
      <div class="flex flex-col sm:flex-row justify-between sm:items-center">
        <!-- Prezzo Placeholder -->
        <div>
          <div class="h-3 bg-gray-300 dark:bg-gray-700 rounded w-20 mb-2"></div>
          <div class="h-9 bg-gray-300 dark:bg-gray-700 rounded w-40"></div> <!-- Modificato: h-10 -> h-9 -->
        </div>
        <!-- Tipo Placeholder -->
        <div class="mt-4 sm:mt-0 sm:text-right">
          <div class="h-3 bg-gray-300 dark:bg-gray-700 rounded w-24 mb-2"></div>
          <div class="h-6 bg-gray-300 dark:bg-gray-700 rounded w-32"></div>
        </div>
      </div>
    </div>
    
    <!-- Barra Statistiche Placeholder -->
    <div class="flex items-center space-x-6 px-5 py-3 bg-gray-50 dark:bg-gray-700/50 border-t border-gray-200 dark:border-gray-700"> <!-- Modificato: px-6 py-4 -> px-5 py-3 -->
      <div class="h-5 bg-gray-300 dark:bg-gray-700 rounded w-16"></div>
      <div class="h-5 bg-gray-300 dark:bg-gray-700 rounded w-20"></div>
      <div class="h-5 bg-gray-300 dark:bg-gray-700 rounded w-14"></div>
    </div>
  </div>
}


