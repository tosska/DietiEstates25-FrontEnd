<div class="container mx-auto p-6 md:p-10 max-w-4xl">
    <h1 class="text-3xl md:text-4xl font-extrabold mb-8 text-gray-900 dark:text-gray-100 border-b-2 border-emerald-500 pb-2">
        Registrazione Agenzia
    </h1>

    <div class="flex justify-between items-center mb-10 relative">
        <div class="absolute top-1/2 left-0 w-full h-1 bg-gray-200 dark:bg-gray-700 -translate-y-1/2">
            <div class="h-full bg-emerald-500 transition-all duration-500 ease-in-out" 
                 [ngStyle]="{'width': (currentStep / 3 * 100) + '%' }"></div>
        </div>

        <div class="flex-1 text-center relative z-10">
            <div class="w-8 h-8 mx-auto rounded-full flex items-center justify-center text-white font-bold transition-all duration-300" 
                 [ngClass]="{'bg-emerald-500 ring-4 ring-emerald-200 dark:ring-emerald-800': currentStep >= 1, 'bg-gray-400 dark:bg-gray-600': currentStep < 1}">
                1
            </div>
            <span class="block mt-2 text-sm font-semibold transition-colors duration-300"
                  [ngClass]="{'text-emerald-600 dark:text-emerald-400': currentStep >= 1, 'text-gray-600 dark:text-gray-400': currentStep < 1}">
                Account Manager
            </span>
        </div>

        <div class="flex-1 text-center relative z-10">
            <div class="w-8 h-8 mx-auto rounded-full flex items-center justify-center text-white font-bold transition-all duration-300" 
                 [ngClass]="{'bg-emerald-500 ring-4 ring-emerald-200 dark:ring-emerald-800': currentStep >= 2, 'bg-gray-400 dark:bg-gray-600': currentStep < 2}">
                2
            </div>
            <span class="block mt-2 text-sm font-semibold transition-colors duration-300"
                  [ngClass]="{'text-emerald-600 dark:text-emerald-400': currentStep >= 2, 'text-gray-600 dark:text-gray-400': currentStep < 2}">
                Indirizzo
            </span>
        </div>

        <div class="flex-1 text-center relative z-10">
            <div class="w-8 h-8 mx-auto rounded-full flex items-center justify-center text-white font-bold transition-all duration-300" 
                 [ngClass]="{'bg-emerald-500 ring-4 ring-emerald-200 dark:ring-emerald-800': currentStep >= 3, 'bg-gray-400 dark:bg-gray-600': currentStep < 3}">
                3
            </div>
            <span class="block mt-2 text-sm font-semibold transition-colors duration-300"
                  [ngClass]="{'text-emerald-600 dark:text-emerald-400': currentStep >= 3, 'text-gray-600 dark:text-gray-400': currentStep < 3}">
                Dati Agenzia
            </span>
        </div>
    </div>

    <div class="bg-white dark:bg-gray-800 p-8 md:p-10 rounded-xl shadow-2xl transition-all duration-500">
        <div *ngIf="currentStep === 1">
            <h2 class="text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100">Crea il tuo account</h2>
            <form [formGroup]="step1" (ngSubmit)="nextStep()">
                <div class="mb-5">
                    <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label>
                    <input id="email" formControlName="email" type="email" 
                           class="w-full rounded-lg border-gray-300 dark:border-gray-700 shadow-sm focus:ring-emerald-500 focus:border-emerald-500 p-3 dark:bg-gray-700 dark:text-gray-100 transition duration-300 placeholder-gray-400"
                           placeholder="Inserisci la tua email">
                    <div *ngIf="step1.get('email')?.invalid && step1.get('email')?.touched" class="text-red-500 text-sm mt-1 font-medium">Email richiesta</div>
                </div>
                <div class="mb-6">
                    <label for="password" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Password</label>
                    <input id="password" formControlName="password" type="password" 
                           class="w-full rounded-lg border-gray-300 dark:border-gray-700 shadow-sm focus:ring-emerald-500 focus:border-emerald-500 p-3 dark:bg-gray-700 dark:text-gray-100 transition duration-300 placeholder-gray-400"
                           placeholder="Minimo 6 caratteri">
                    <div *ngIf="step1.get('password')?.invalid && step1.get('password')?.touched" class="text-red-500 text-sm mt-1 font-medium">Password richiesta (min 6 caratteri)</div>
                </div>
                <button type="submit" 
                        class="w-full bg-emerald-500 text-white py-3 px-6 rounded-lg font-semibold hover:bg-emerald-600 focus:outline-none focus:ring-4 focus:ring-emerald-300 dark:focus:ring-emerald-700 transition duration-300 disabled:opacity-50"
                        [disabled]="step1.invalid">
                    Avanti
                </button>
            </form>
        </div>

        <div *ngIf="currentStep === 2">
            <h2 class="text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100">Dettagli Indirizzo dell'Agenzia</h2>
            <form [formGroup]="step2" (ngSubmit)="nextStep()">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="mb-4">
                        <label for="street" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Via / Indirizzo</label>
                        <input id="street" formControlName="street" class="w-full rounded-lg border-gray-300 dark:border-gray-700 shadow-sm focus:ring-emerald-500 focus:border-emerald-500 p-3 dark:bg-gray-700 dark:text-gray-100 transition duration-300">
                    </div>
                    <div class="mb-4">
                        <label for="city" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Città</label>
                        <input id="city" formControlName="city" class="w-full rounded-lg border-gray-300 dark:border-gray-700 shadow-sm focus:ring-emerald-500 focus:border-emerald-500 p-3 dark:bg-gray-700 dark:text-gray-100 transition duration-300">
                    </div>
                    <div class="mb-4">
                        <label for="postalCode" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">CAP</label>
                        <input id="postalCode" formControlName="postalCode" class="w-full rounded-lg border-gray-300 dark:border-gray-700 shadow-sm focus:ring-emerald-500 focus:border-emerald-500 p-3 dark:bg-gray-700 dark:text-gray-100 transition duration-300">
                    </div>
                    <div class="mb-4">
                        <label for="state" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Regione</label>
                        <input id="state" formControlName="state" class="w-full rounded-lg border-gray-300 dark:border-gray-700 shadow-sm focus:ring-emerald-500 focus:border-emerald-500 p-3 dark:bg-gray-700 dark:text-gray-100 transition duration-300">
                    </div>
                </div>
                
                <div class="mb-4">
                    <label for="unitDetail" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Dettagli Unità (es. Piano, interno, civico)</label>
                    <input id="unitDetail" formControlName="unitDetail" class="w-full rounded-lg border-gray-300 dark:border-gray-700 shadow-sm focus:ring-emerald-500 focus:border-emerald-500 p-3 dark:bg-gray-700 dark:text-gray-100 transition duration-300">
                </div>
                
                <div class="flex justify-between mt-6">
                    <button type="button" (click)="prevStep()" 
                            class="bg-gray-200 text-gray-700 py-3 px-6 rounded-lg font-semibold hover:bg-gray-300 focus:outline-none focus:ring-4 focus:ring-gray-300 transition duration-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600">
                        Indietro
                    </button>
                    <button type="submit" 
                            class="bg-emerald-500 text-white py-3 px-6 rounded-lg font-semibold hover:bg-emerald-600 focus:outline-none focus:ring-4 focus:ring-emerald-300 dark:focus:ring-emerald-700 transition duration-300 disabled:opacity-50"
                            [disabled]="step2.invalid">
                        Avanti
                    </button>
                </div>
            </form>
        </div>

        <div *ngIf="currentStep === 3">
            <h2 class="text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100">Dati dell'Agenzia</h2>
            <form [formGroup]="step3" (ngSubmit)="onSubmit()">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="mb-4">
                        <label for="phone" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Telefono</label>
                        <input id="phone" formControlName="phone" 
                               class="w-full rounded-lg border-gray-300 dark:border-gray-700 shadow-sm focus:ring-emerald-500 focus:border-emerald-500 p-3 dark:bg-gray-700 dark:text-gray-100 transition duration-300"
                               placeholder="+39 XXX XXX XXXX">
                        <div *ngIf="step3.get('phone')?.invalid && step3.get('phone')?.touched" class="text-red-500 text-sm mt-1 font-medium">Telefono richiesto</div>
                    </div>
                    <div class="mb-4">
                        <label for="vatNumber" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Partita IVA</label>
                        <input id="vatNumber" formControlName="vatNumber" 
                               class="w-full rounded-lg border-gray-300 dark:border-gray-700 shadow-sm focus:ring-emerald-500 focus:border-emerald-500 p-3 dark:bg-gray-700 dark:text-gray-100 transition duration-300"
                               placeholder="ITXXXXXXXXXXX">
                        <div *ngIf="step3.get('vatNumber')?.invalid && step3.get('vatNumber')?.touched" class="text-red-500 text-sm mt-1 font-medium">Partita IVA richiesta</div>
                    </div>
                </div>
                
                <div class="mb-4">
                    <label for="website" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Sito Web (opzionale)</label>
                    <input id="website" formControlName="website" type="url" 
                           class="w-full rounded-lg border-gray-300 dark:border-gray-700 shadow-sm focus:ring-emerald-500 focus:border-emerald-500 p-3 dark:bg-gray-700 dark:text-gray-100 transition duration-300"
                           placeholder="https://www.tuasito.it">
                </div>

                <div class="mb-6">
                    <label for="description" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Descrizione (Breve presentazione)</label>
                    <textarea id="description" formControlName="description" rows="4"
                              class="w-full rounded-lg border-gray-300 dark:border-gray-700 shadow-sm focus:ring-emerald-500 focus:border-emerald-500 p-3 dark:bg-gray-700 dark:text-gray-100 transition duration-300"
                              placeholder="Descrivi brevemente la tua agenzia..."></textarea>
                </div>
                
                <div class="flex justify-between mt-6">
                    <button type="button" (click)="prevStep()" 
                            class="bg-gray-200 text-gray-700 py-3 px-6 rounded-lg font-semibold hover:bg-gray-300 focus:outline-none focus:ring-4 focus:ring-gray-300 transition duration-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600">
                        Indietro
                    </button>
                    <button type="submit" 
                            class="bg-emerald-500 text-white py-3 px-6 rounded-lg font-semibold hover:bg-emerald-600 focus:outline-none focus:ring-4 focus:ring-emerald-300 dark:focus:ring-emerald-700 transition duration-300 disabled:opacity-50"
                            [disabled]="step3.invalid">
                        Registrati
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>